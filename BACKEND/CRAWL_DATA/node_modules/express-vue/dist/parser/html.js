'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _pug = require('pug');

var _pug2 = _interopRequireDefault(_pug);

var _htmlMinifier = require('html-minifier');

var _htmlMinifier2 = _interopRequireDefault(_htmlMinifier);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var htmlRegex = /(<template.*?>)([\s\S]*)(<\/template>)/gm;

function htmlParser(body, regex, minify) {
    if (!regex) {
        regex = htmlRegex;
    }
    var bodyArray = body.match(htmlRegex) || [];
    var bodyString = bodyArray[0];
    var templateLang = bodyString.replace(htmlRegex, '$1');
    if (bodyString) {
        bodyString = bodyString.replace(htmlRegex, '$2');
        if (templateLang.includes('lang="pug"') || templateLang.includes('lang="jade"')) {
            bodyString = _pug2.default.compile(bodyString, {})({});
        }
    }

    if (minify) {
        bodyString = _htmlMinifier2.default.minify(bodyString, {
            collapseWhitespace: true
        });
    }

    return bodyString;
}

exports.default = htmlParser;
module.exports = exports['default'];